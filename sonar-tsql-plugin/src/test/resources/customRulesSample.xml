<sql-rules repoName="Custom rules" repoKey="CustomRepo1">
    <rule>
        <key>C001</key>
        <name>Waitfor is used.</name>
        <internalKey>C001</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>Waitfor is used</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Waitfor_statementContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules/>
            <siblingsRules/>
            <usesRules/>
            <ruleViolationMessage>Waitfor is used.</ruleViolationMessage>
            <times>0</times>
            <ruleMode>Default</ruleMode>
            <ruleMatchType>ClassOnly</ruleMatchType>
            <ruleResultType>FailIfFound</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C002</key>
        <name>SELECT * is used</name>
        <internalKey>C002</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>SELECT * is used. Please list names.</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Select_listContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules>
                <ruleImplementation>
                    <names>
                        <textItem>Select_list_elemContext</textItem>
                    </names>
                    <textToFind>
                        <textItem>*</textItem>
                    </textToFind>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>SELECT * is used</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>TextAndClass</ruleMatchType>
                    <ruleResultType>FailIfFound</ruleResultType>
                    <textCheckType>Strict</textCheckType>
                </ruleImplementation>
            </childrenRules>
            <siblingsRules/>
            <usesRules/>
            <times>0</times>
            <ruleMode>Default</ruleMode>
            <ruleMatchType>Default</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C003</key>
        <name>Cursor lifecycle is violated</name>
        <internalKey>C003</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>Cursor lifecycle is violated. Cursor either is not opened, deallocated or closed.</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Cursor_nameContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules/>
            <siblingsRules/>
            <usesRules>
                <ruleImplementation>
                    <names>
                        <textItem>Cursor_statementContext</textItem>
                    </names>
                    <textToFind>
                        <textItem>OPEN</textItem>
                    </textToFind>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Cursor was not opened.</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>Full</ruleMatchType>
                    <ruleResultType>FailIfNotFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
                <ruleImplementation>
                    <names>
                        <textItem>Cursor_statementContext</textItem>
                    </names>
                    <textToFind>
                        <textItem>DECLARE</textItem>
                    </textToFind>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Cursor was not declared.</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>Full</ruleMatchType>
                    <ruleResultType>FailIfNotFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
                <ruleImplementation>
                    <names>
                        <textItem>Cursor_statementContext</textItem>
                    </names>
                    <textToFind>
                        <textItem>CLOSE</textItem>
                    </textToFind>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Cursor was not closed.</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>Full</ruleMatchType>
                    <ruleResultType>FailIfNotFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
                <ruleImplementation>
                    <names>
                        <textItem>Cursor_statementContext</textItem>
                    </names>
                    <textToFind>
                        <textItem>DEALLOCATE</textItem>
                    </textToFind>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Cursor was not deallocated.</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>Full</ruleMatchType>
                    <ruleResultType>FailIfNotFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
            </usesRules>
            <times>0</times>
            <ruleMode>Group</ruleMode>
            <ruleMatchType>Default</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C004</key>
        <name>INSERT statement does not have columns listed</name>
        <internalKey>C004</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>&lt;h2&gt;Description&lt;/h2&gt;&lt;p&gt;Always use a column list in your INSERT statements.&lt;/p&gt;</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Insert_statementContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules>
                <ruleImplementation>
                    <names>
                        <textItem>Column_name_listContext</textItem>
                    </names>
                    <textToFind/>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Column list is not specified in an insert statement</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>ClassOnly</ruleMatchType>
                    <ruleResultType>FailIfNotFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
            </childrenRules>
            <siblingsRules/>
            <usesRules/>
            <times>0</times>
            <ruleMode>Default</ruleMode>
            <ruleMatchType>Default</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C005</key>
        <name>Do not use column numbers in the ORDER BY clause</name>
        <internalKey>C005</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>Always use column names in an order by clause. Avoid positional references.</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Order_by_clauseContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules>
                <ruleImplementation>
                    <names>
                        <textItem>ConstantContext</textItem>
                    </names>
                    <textToFind/>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Column number is used instead of name in order by clause</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>ClassOnly</ruleMatchType>
                    <ruleResultType>FailIfFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
            </childrenRules>
            <siblingsRules/>
            <usesRules/>
            <ruleViolationMessage></ruleViolationMessage>
            <times>0</times>
            <ruleMode>Default</ruleMode>
            <ruleMatchType>Default</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C006</key>
        <name>Bad practice</name>
        <internalKey>C006</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>Execute/exec for dynamic query was used. It is better to use sp_execute for dynamic queries..</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Execute_statementContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules>
                <ruleImplementation>
                    <names>
                        <textItem>ConstantContext</textItem>
                    </names>
                    <textToFind/>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Execute/exec for dynamic query was used. It is better to use sp_execute for dynamic queries.</ruleViolationMessage>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>ClassOnly</ruleMatchType>
                    <ruleResultType>FailIfFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
            </childrenRules>
            <siblingsRules/>
            <usesRules/>
            <times>0</times>
            <ruleMode>Default</ruleMode>
            <ruleMatchType>ClassOnly</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C007</key>
        <name>Multiple cursor declarations found</name>
        <internalKey>C007</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>Multiple cursor declarations found</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Cursor_nameContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules/>
            <siblingsRules/>
            <usesRules>
                <ruleImplementation>
                    <names>
                        <textItem>Cursor_statementContext</textItem>
                    </names>
                    <textToFind>
                        <textItem>DECLARE</textItem>
                    </textToFind>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules/>
                    <ruleViolationMessage>Cursor was declared multiple times.</ruleViolationMessage>
                    <times>1</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>Full</ruleMatchType>
                    <ruleResultType>FailIfMoreFound</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
            </usesRules>
            <times>0</times>
            <ruleMode>Group</ruleMode>
            <ruleMatchType>Default</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
    <rule>
        <key>C008</key>
        <name>Cursor was closed in a control statement</name>
        <internalKey>C008</internalKey>
        <descriptionFormat>HTML</descriptionFormat>
        <description>Cursor was closed or deallocated in a different control statement than declared.</description>
        <severity>MINOR</severity>
        <cardinality>SINGLE</cardinality>
        <status>READY</status>
        <remediationFunction>LINEAR</remediationFunction>
        <debtRemediationFunctionCoefficient>5min</debtRemediationFunctionCoefficient>
        <ruleImplementation>
            <names>
                <textItem>Cursor_nameContext</textItem>
            </names>
            <textToFind/>
            <parentRules/>
            <childrenRules/>
            <siblingsRules/>
            <usesRules>
                <ruleImplementation>
                    <names>
                        <textItem>Declare_cursorContext</textItem>
                    </names>
                    <textToFind/>
                    <parentRules/>
                    <childrenRules/>
                    <siblingsRules/>
                    <usesRules>
                        <ruleImplementation>
                            <names>
                                <textItem>Cursor_statementContext</textItem>
                            </names>
                            <textToFind>
                                <textItem>CLOSE</textItem>
                            </textToFind>
                            <parentRules/>
                            <childrenRules/>
                            <siblingsRules/>
                            <usesRules/>
                            <ruleViolationMessage>Cursor was closed in a different control statement.</ruleViolationMessage>
                            <times>0</times>
                            <ruleMode>Default</ruleMode>
                            <ruleMatchType>Strict</ruleMatchType>
                            <ruleResultType>FailIfNotFound</ruleResultType>
                            <textCheckType>Default</textCheckType>
                        </ruleImplementation>
                        <ruleImplementation>
                            <names>
                                <textItem>Cursor_statementContext</textItem>
                            </names>
                            <textToFind>
                                <textItem>DEALLOCATE</textItem>
                            </textToFind>
                            <parentRules/>
                            <childrenRules/>
                            <siblingsRules/>
                            <usesRules/>
                            <ruleViolationMessage>Cursor was deallocated in a different control statement.</ruleViolationMessage>
                            <times>0</times>
                            <ruleMode>Default</ruleMode>
                            <ruleMatchType>Strict</ruleMatchType>
                            <ruleResultType>FailIfNotFound</ruleResultType>
                            <textCheckType>Default</textCheckType>
                        </ruleImplementation>
                    </usesRules>
                    <times>0</times>
                    <ruleMode>Default</ruleMode>
                    <ruleMatchType>Full</ruleMatchType>
                    <ruleResultType>Default</ruleResultType>
                    <textCheckType>Default</textCheckType>
                </ruleImplementation>
            </usesRules>
            <times>0</times>
            <ruleMode>Group</ruleMode>
            <ruleMatchType>Default</ruleMatchType>
            <ruleResultType>Default</ruleResultType>
            <textCheckType>Default</textCheckType>
        </ruleImplementation>
    </rule>
</sql-rules>

